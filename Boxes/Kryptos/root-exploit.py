import random 
import json
import hashlib
import binascii
import requests
from ecdsa import VerifyingKey, SigningKey, NIST384p


url = 'http://127.0.0.1:81/eval'

with open('out.txt','r') as f:
	for i,line in enumerate(f,start=1):
		try:
			line = line.replace('\n','')
			line = int(line)+1
			expr = '''3+3'''
			sk = SigningKey.from_secret_exponent(line, curve=NIST384p)
			sign = binascii.hexlify(sk.sign(str.encode(expr)))
			data = {'expr':expr,'sig':str.decode(sign)}
			headers = {'Content-Type': 'application/json'}
			r = requests.post(url,data=json.dumps(data),headers=headers)
			if not 'Bad signature' in r.text:
				print "Sign : {}".format(sign)
				print r.text
				break
			else:
				print '{} retrying..'.format(i)
				print r.text
				continue
		except:
			print 'int error'
			continue
